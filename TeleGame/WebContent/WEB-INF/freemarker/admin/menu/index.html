<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<link rel="stylesheet" href="${rc.contextPath}/admin/css/css.css"/>
<script src="${rc.contextPath}/admin/js/jquery/jquery-2.1.1.min.js" type="text/javascript"></script>
 <script type="text/javascript" src="${rc.contextPath}/admin/js/noty-2.2.2/js/noty/packaged/jquery.noty.packaged.min.js"></script>
 <script type="text/javascript" src="${rc.contextPath}/admin/js/noty-2.2.2/js/noty/layouts/center.js"></script>
<script type="text/javascript" src="${rc.contextPath}/admin/js/noty-2.2.2/js/noty/themes/default.js"></script>
<script type="text/javascript" src="${rc.contextPath}/admin/js/layer/layer.min.js"></script>

<SCRIPT type=text/javascript>
function selectTag(showContent,selfObj){
	// 操作标签
	var tag = document.getElementById("tags").getElementsByTagName("li");
	var taglength = tag.length;
	for(i=0; i<taglength; i++){
		tag[i].className = "";
	}
	selfObj.parentNode.className = "selectTag";
	// 操作内容
	for(i=0; j=document.getElementById("tagContent"+i); i++){
		j.style.display = "none";
	}
	document.getElementById(showContent).style.display = "block";	
}
</SCRIPT>
</head>

<body class="body-index">
<div class="wp">
<!--头部开始-->
<div class="header">
	<div class="title"></div>
    <div class="user">
    	<div class="userleft"></div>
        <div class="usercenter">
        	<ul>
            	<li class="icon04">当前用户：Staff Chen</li>
                <li class="icon05"><a href="#">注 销</a></li>
            </ul>
        </div>
        <div class="userright"></div>
    </div>
</div>
<!--头部结束-->
<!--内容开始-->
<div class="content">
	<!--左边菜单开始-->
	<div class="left">
   		<ul class="sub">
   	    	<li><div class="icon1"><a href="content.html" class="hover-arrow">首页</a></div></li>
            <li><div class="icon9"><a href="content.html">消息</a></div></li>
        	<li><div class="icon2"><a href="#">满意</a></div></li>
        	<li>
            	<div class="icon3"><a href="#">制卡及库存</a></div>
                <ul class="meun">
                	<li><a href="#">申请卡片</a></li>
                    <li><a href="#">申请审批</a></li>
                    <li><a href="#">制卡</a></li>
                    <li><a href="#">库存调配</a></li>
                    <li><a href="#">店内库存管理</a></li>
                    <li><a href="#">查询</a></li>
                    <li><a href="#">收获</a></li>
                </ul>
            </li>
        	<li>
            	<div class="icon4"><a href="#">售卡管理</a></div>
            	<ul class="meun">
                	<li><a href="#">批量售卡</a></li>
                    <li><a href="#">折扣维护</a></li>
                 </ul>
            </li>
        	<li>
            	<div class="icon5"><a href="#">账户管理</a></div>
                <ul class="meun">
                	<li><a href="#">单卡管理</a></li>
                    <li><a href="#">批量管理</a></li>
                    <li><a href="#">交易明细查询</a></li>
                </ul>
            </li>
            <li><div class="icon6"><a href="#">对账查询</a></div></li>
        	<li>
            	<div class="icon6"><a href="#">统计查询</a></div>
                <ul class="meun">
                	<li><a href="#">交易明细查询</a></li>
                    <li><a href="#">交易统计查询</a></li>
                </ul>
            </li>
            <li>
            	<div class="icon7"><a href="report.html">报表</a></div>
                <ul class="meun">
                	<li><a href="#">管理报表</a></li>
                    <li><a href="#">清算报表</a></li>
                    <li><a href="#">交易报表</a></li>
                </ul>
            </li>
            <li><div class="icon8"><a href="#">用户管理</a></div></li>
            <li>
            	<div class="icon10"><a href="#">福利发放</a></div>
            </li>
      	</ul>
	</div>
    <!--左边菜单结束-->
    <!--右边内容开始-->
    <div class="right">
    	<!--当前开始-->
    	<ul class="current">
            <li><a href="#" class="position01">当前位置</a><span class="ar01"></span></li>
            <li><a href="#" class="position02">预付费卡综合管理系统</a><span class="ar02"></span></li>
            <li><a href="#" >系统菜单管理</a></li>
        </ul>
        <!--当前结束-->
        <!--正文开始-->
        <div class="contain">		
           <!--报表开始-->
            <div class="common">
                <div class="from from01">
                	<ul id="tags">一级菜单列表</ul>
                    <div id="tagContent">
    					<div class="tagContent selectTag" id="tagContent0">
                        	<table width="100%" border="0" cellspacing="0" cellpadding="0">
							
                              <tr>
                                <th>选择</th>
                                <th>编号</th>
                                <th>菜单名称</th>
                                <th>URL</th>
                                <th>排序号</th>
                                <th>子菜单数</th>
                                <th>状态</th>
                                <th>操作</th>
                              </tr>
							  <#if menuList??>
								<#list menuList as menu>
								<tr>
									<td><input type="radio" name="radio" id="radio" value="radio" />
									<label for="radio"></label></td>
									<td >${menu.id!""}</td>
									<td id="m_name_${menu.id!""}">${menu.menuName!""}</td>
									<td id="m_url_${menu.id!""}">${menu.url!""}</td>
									<td id="m_orderNum_${menu.id!""}">${menu.orderNum!""}</td>
									<td>${menu.childCount!""}</td>
									<td id="m_status_${menu.id!""}"><#if (menu.status == 0)>正常<#else>禁用</#if></td>
									<td><a href="" onclick="return false;">删除</a> <span style="cursor:pointer;text-decoration:underline;" onclick="edit_menu(${menu.id!""})">编辑</span></td>
								</tr>
								</#list>
							 </#if>                              
                            </table>
							 <div class="from-bottom">
								<input name="input" type="button" class="style04" onclick="add_menu(-1)" value="新增一级菜单" />
								<input name="input" type="button" class="style04" value="管理二级菜单" />
							</div>
                        </div>    					
    				</div>
                </div>                
                <div class="from from01">
                	<ul id="tags">差异明细</ul>
                    <div id="tagContent">
    					<div class="tagContent selectTag" id="tagContent0">
                        	<table width="100%" border="0" cellspacing="0" cellpadding="0">
                                  <tr>
                                    <th>&nbsp;</th>
                                    <th>门店</th>
                                    <th>卡号</th>
                                    <th>流水号</th>
                                    <th>交易日期</th>
                                    <th>交易金额</th>
                                    <th>多方</th>
                                    <th>处理结果</th>
                                  </tr>
                                  <tr>
                                    <td><input type="radio" name="radio" id="radio" value="radio" />
                                <label for="radio"></label></td>
                                    <td>上海市场部-肯德基-淮海西路店</td>
                                    <td>12345678909</td>
                                    <td>LS123445677</td>
                                    <td>2012-11-23 12:13:22</td>
                                    <td>3000.00</td>
                                    <td>百胜</td>
                                    <td>是</td>
                                  </tr>
                                  <tr>
                                    <td><input type="radio" name="radio" id="radio" value="radio" />
                                <label for="radio"></label></td>
                                    <td>上海市场部-肯德基-淮海西路店</td>
                                    <td>12345678909</td>
                                    <td>LS123445677</td>
                                    <td>2012-11-23 12:13:22</td>
                                    <td>&nbsp;</td>
                                    <td>CFC</td>
                                    <td>否</td>
                                  </tr>
                                </table>

    					 
   					  </div>    					
    				</div>
                </div>                                
            </div>
            <!--报表结束-->
        </div>
        <!--正文结束-->
    </div>
    <!--右边内容结束-->
</div>
<!--内容结束-->
<!--尾部开始-->
<div class="footer">
	<span>(c) 版权所有 2014 平安付智能技术有限公司 版权所有</span>
    <a href="#">隐私策略</a> <a href="#">网站地图</a> <a href="#">帮助中心</a>
</div>
<!--尾部结束-->
</div>

<input type="hidden" id="edit_id" value=""/>
<script>
function edit_menu(menuid){
		$("#edit_id").val(menuid);
		$.layer({
			type : 2,
			shade : [0.5 , '#000' , true],
			loading : {type : 0},
			fix: false,
			title : ['编辑菜单',true],
			iframe : {src : '${rc.contextPath}/admin/menu/edit?menuId=' + menuid},
			area : ['750px' , '350px'],
			offset : ['150px', ''],
			close : function(index){
				layer.close(index);
			},
			end : function(){	
				reload_menu();
			}
		});
		
		//return false;
}

function add_menu(level){
		$.layer({
			type : 2,
			shade : [0.5 , '#000' , true],
			loading : {type : 0},
			fix: false,
			title : ['编辑菜单',true],
			iframe : {src : '${rc.contextPath}/admin/menu/add?level=' + level},
			area : ['750px' , '350px'],
			offset : ['150px', ''],
			close : function(index){
				layer.close(index);
			},
			end : function(){	
				window.location = window.location;
			}
		});
		
}



function reload_menu(){
	var mid = $("#edit_id").val();
	var text_name=$("#m_name_" + mid);
	var text_url=$("#m_url_" + mid);
	var text_orderNum=$("#m_orderNum_" + mid);
	var text_status=$("#m_status_" + mid);

	
	
	$.ajax({     
		url:'${rc.contextPath}/admin/menu/sigleInfo',     
		type:'post',     
		data:{
			menuId: mid
		},     
		async : false, //默认为true 异步     
		error:function(){     
			noty({text: "系统发生异常，请联系管理员",  type:"error",layout: "bottomRight", timeout: 2000});   
		},     
		success:function(res){   
			if(res.action_status !=1 ){
				noty({text: res.action_message,  type:"error",layout: "bottomRight", timeout: 2000});
			}else{
				text_name.text(res.action_data.menuName);
				text_url.text(res.action_data.url);
				text_orderNum.text(res.action_data.orderNum);
				if(res.action_data.status == 0){
					text_status.text("正常");
				}else{
					text_status.text("禁用");
				}
				
			}
		}  
	});
}

</script>
</body>
</html>
